객체지향의 본질은 협력하는 객체들의 공동체를 창조하는 것이다. 클래스나 상속과 같은 구현 메커니즘은 객체들의 책임과 협력이 자리를 잡은 후에야 의미가 있다.

## 01. 협력

### 영화 예매 시스템 돌아보기

애플리케이션의 제어 흐름은 어떤 하나의 객체에 의해 통제되지 않고 다양한 객체들 사이에 균형 있게 분배된다.
객체들은 요청의 흐름을 따라 자신에게 분배된 로직을 실행하면서 전체 기능을 완성한다.

### 협력

> 협력 : 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용.  
> 메시지 전송 : 객체 사이의 협력을 위해 사용할 수 있는 유일한 커뮤니케이션 수단.

객체는 고립된 존재가 아니라 시스템의 기능을 구현하기 위해 다른 객체와 협력하는 사회적인 존재이다.
메시지를 수신한 객체는 메서드를 실행해 요청에 응답하며, 메시지를 처리할 방법을 스스로 결정하는 자율적인 존재이다.

### 협력이 설계를 위한 문맥을 결정한다

객체가 시스템에 존재하는 이유는 단 하나, 어떤 협력에 참여하고 있기 때문이다. 협력은 객체가 필요한 이유와 객체가 수행할 행동의 동기를 제공하며,
결과적으로 객체의 행동과 상태 모두를 결정하는 `문맥(context)`이 된다.

## 02. 책임

### 책임이란 무엇인가

객체를 설계하기 위해 협력이라는 문맥이 갖춰졌다면, 다음으로 할 일은 협력에 필요한 행동을 수행할 적절한 객체를 찾는 것이다. 이때 협력에 참여하기 위해 객체가 수행하는 행동을 책임이라고 부른다.

> 하는 것(doing) : 객체를 생성하거나 계산을 수행하는 등 스스로 하는 것, 다른 객체의 행동을 시작시키는 것, 다른 객체의 활동을 제어하고 조절하는 것.  
> 아는 것(knowing) : 사적인 정보에 관해 아는 것, 관련된 객체에 관해 아는 것, 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것.

### 책임 할당

자율적인 객체를 만드는 가장 기본적인 방법은 책임을 수행하는 데 필요한 정보를 가장 잘 알고 있는
`정보 전문가(INFORMATION EXPERT)`에게 책임을 할당하는 것이다. 정보를 소유하고 있거나 해당 정보의 소유자를 가장 잘 아는 객체에게 책임을 맡겨야 한다.

### 책임 주도 설계

협력을 설계하기 위해 책임에 초점을 맞추는 설계 방법인 `책임 주도 설계(RDD)`는 다음과 같은 과정을 거친다.

- 시스템 책임을 파악하고 더 작은 책임으로 분할한다.
- 책임을 수행할 적절한 객체나 역할을 찾아 할당한다.
- 객체가 책임을 수행하는 도중 도움이 필요하면 다른 객체에게 도움을 요청하여 협력하게 한다.

### 메시지가 객체를 결정한다

객체에게 책임을 할당하는 데 필요한 메시지를 먼저 식별하고, 그 메시지를 처리할 객체를 나중에 선택해야 한다.
이를 통해 객체는 최소한의 인터페이스를 가질 수 있으며, 충분히 추상적인 인터페이스를 확보하게 된다.

### 행동이 상태를 결정한다

객체를 객체답게 만드는 것은 상태가 아니라 객체가 다른 객체에게 제공하는 행동이다.
상태를 먼저 결정하고 행동을 나중에 고민하는 데이터 주도 설계는 캡슐화를 저해하고 객체를 고립시킨다.

## 03. 역할

### 역할과 협력

> 역할 : 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합.

협력을 모델링할 때는 특정한 객체가 아니라 익명의 역할에게 책임을 할당한다고 생각하는 것이 좋다.
역할은 협력이라는 문맥 안에서 객체가 수행하는 책임의 응집된 묶음이다.

### 유연하고 재사용 가능한 협력

역할은 협력 내에서 다른 구체적인 객체로 교체할 수 있는 `슬롯(placeholder)`과 같다.
역할을 통해 협력을 추상화하면 다양한 종류의 객체가 동일한 협력에 참여할 수 있게 되어 설계의 유연성과 재사용성이 높아진다.

### 객체 대 역할

협력에 참여하는 후보가 여러 종류라면 역할로 추상화하고, 참여하는 후보가 한 종류뿐이라면 구체적인 객체로 간주한다.
설계 초반에는 구체적인 객체로 시작하더라도 반복적인 정제를 통해 유사한 협력 패턴이 발견되면 역할을 분리해내는 것이 좋다.

### 역할과 추상화

추상화의 장점은 세부 사항에 억눌리지 않고 상위 수준의 정책을 단순화할 수 있다는 것과 설계를 유연하게 만든다는 것이다.
역할은 공통의 책임을 바탕으로 객체의 종류를 숨기는 추상화의 일종이므로 이러한 장점을 모두 가진다.

### 배우와 배역

연극의 배우가 배역을 연기하는 것처럼, 객체는 협력이라는 문맥 안에서 일시적으로 역할을 맡아 책임을 수행한다.
역할은 협력이 진행되는 동안에만 존재하는 일시적인 개념이며, 객체는 협력이 끝나면 역할을 벗고 원래의 객체로 돌아온다.

## 정리

훌륭한 객체지향 설계는 클래스를 설계하는 것이 아니라 객체들 사이의 적절한 협력을 식별하고, 협력에 필요한 역할을 정의한 후,
이를 수행할 수 있는 적절한 객체에게 책임을 할당하는 것이다. 설계의 본질은 역할, 책임, 협력이라는 세 요소의 균형에 있다.